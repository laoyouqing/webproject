{%extends 'df_goods/base.html'%}


{%block head%}
<script>
  $(function () {
      $('.add_goods').click(function () {
          sku_id=$(this).attr('sku_id')
            csrf=$('input[name="csrfmiddlewaretoken"]').val()
            //组织参数
            params={'sku_id':sku_id,'count':1,'csrfmiddlewaretoken':csrf}

            //发送ajax post请求，访问/cart/add
            $.post('/cart/add/',params,function (data) {
                if(data.res == 5){
                    $('#show_count').html(data.total_count);
                }
                else {
                    //添加失败
                    alert(data.errmsg)
                }
            })
      })
  })
</script>
{%endblock head%}


{% block detail %}
<div class="breadcrumb">
		<a href="/goods/">全部分类</a>
		<span>></span>
		<a href="#">{{ goodstype.name }}</a>
</div>
{% endblock detail %}

{% block left %}
    {% csrf_token %}
<div class="r_wrap fr clearfix">
			<div class="sort_bar">
				<a href="/goods/list/{{  goodstype.id }}_1_1/" {% if sort == '1'%} class="active"{% endif %}>默认</a>
				<a href="/goods/list/{{  goodstype.id }}_1_2/" {% if sort == '2'%} class="active"{% endif %}>价格</a>
				<a href="/goods/list/{{  goodstype.id }}_1_3/" {% if sort == '3'%} class="active"{% endif %}>人气</a>
			</div>

			<ul class="goods_type_list clearfix">
                {% for sku in my_page.object_list %}
                    <li>
                        <a href="/goods/detail/{{ sku.id }}"><img src="{{ sku.image.url }}"></a>
                        <h4><a href="/goods/detail/{{ sku.id }}">{{ sku.name }}</a></h4>
                        <div class="operate">
                            <span class="prize">{{ sku.price }}</span>
                            <span class="unit">{{ sku.price }}/{{ sku.unite }}</span>
                            <a href="#" class="add_goods"  title="加入购物车" sku_id="{{ sku.id }}"></a>
                        </div>
                    </li>
                {% endfor %}
			</ul>

			<div class="pagenation">
                {% if my_page.has_previous %}
                    <a href="/goods/list/{{ goodstype.id }}_{{ my_page.previous_page_number  }}_{{ sort }}">上一页</a>
                {% else %}
                    <a>上一页</a>
                {% endif %}

                {% for page in page_list %}
                    {% if page == my_page.number %}
                        <a class="active">{{ page }}</a>
                    {% else %}
                       <a href="/goods/list/{{ goodstype.id }}_{{ page }}_{{ sort }}">{{ page }}</a>
                    {% endif %}
                {% endfor %}
                {% if my_page.has_next %}
                    <a href="/goods/list/{{ goodstype.id }}_{{ my_page.next_page_number }}_{{ sort }}">下一页</a>
                {% else %}
                    <a>下一页</a>
                {% endif %}

{#				<a href="#">上一页</a>#}
{#				<a href="#" class="active">1</a>#}
{#				<a href="#">2</a>#}
{#				<a href="#">3</a>#}
{#				<a href="#">4</a>#}
{#				<a href="#">5</a>#}
{#				<a href="#">下一页></a>#}
			</div>
		</div>
	</div>
{% endblock left %}

